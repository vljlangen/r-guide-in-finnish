[["index.html", "R-opas 1 Alkusanat", " R-opas Ville Lang√©n 20.12.2022 1 Alkusanat T√§ss√§ pikaohjeessa opastetaan, miten: asennat Maciin R-ohjelmointikielen asennat Maciin RStudio-ohjelman, jolla teet tilastoajoja teet helppoja tilastoanalyysej√§ kirjoittamalla R- ja R Markdown -koodia √Ñl√§ huolestu, jos et tajunnut yll√§ olevasta paljoakaan. Aiempaa kokemusta tilastollisesta analyysista et tarvitse. Suunnitelmissani on viel√§ tehd√§ todellinen pikaversio t√§st√§ ohjeesta h√§t√§housuille. Tuossa versiossa kurssin pakinat ohitetaan suoraan ja p√§√§stet√§√§n lukija tekem√§√§n yksin√§√§n analyysej√§ valmiiksi tekemill√§ni sabluunoilla. Disclaimer: olen itse puhdas kliinikko, ja n√§m√§ verkkosivut heijastavat l√§hinn√§ omia kokemuksiani tilastoajoista biostatistiikassa. Statistiikan k√§sitteit√§ tuon t√§ss√§ esille varsin anekdotaalisesti. Voit opetella omien k√§ytt√∂tarkoituksiesi mukaisesti lis√§√§ tilastotiedett√§ ja R:n k√§ytt√∂√§ esim. internetist√§. T√§m√§ opas on saatavilla my√∂s englanniksi: this short guide is available also in English. Kiitokset: Esit√§n l√§mpim√§t kiitokset LT Joonatan Palmulle t√§m√§n R-oppaan tarkastamisesta. Joonatan on yst√§v√§llisesti lis√§ksi laatinut t√§h√§n oppaaseen liiteosion, jossa k√§sitell√§√§n versionhallintaa. Suosittelen perehtym√§√§n aiheeseen lukemalla liiteosion heti t√§m√§n pikaoppaan jatkeeksi. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["r-kieli.html", "2 R-kieli", " 2 R-kieli R on ohjelmointikieli, jonka saa asennettua tietokoneelleen ilmaiseksi ja jolla saa tehty√§ paitsi tilastoajot my√∂s kuvaajat tieteellist√§ artikkelia laadittaessa. Jos tutkijan valinta on vapaa, rohkenen suositella, ett√§ aloitteleva tutkija aloittaa nyky√§√§n suoraan R:st√§. Vaikka osaisi jo esim. SASia tai SPSS:√§√§, R:√§√§ kannattaa opetella hieman jo pelk√§st√§√§n kuvaajien tekoa varten. R:n etuja: ilmainen asennus helppoa kevyt - vie v√§h√§n tilaa tietokoneelta k√§ytt√∂apua saa nopeasti ja helposti internetist√§ kuvaajien tekoon erinomainen yksin√§√§nkin riitt√§√§ tavanomaisen v√§it√∂skirjan analyyseihin Ihan ‚Äúkarvalakkina‚Äù koodattava R-kieli (ns. Base-R) on mielest√§ni hieman luotaanty√∂t√§v√§√§. Mutta kun R-kielt√§ laaditaan lis√§osan, ns. dplyr-paketin kanssa, koodia on hyvin helppo aloittelijankin tehd√§ ja koodin ymm√§rt√§minen on intuitiivista. T√§ss√§ pikaohjeessa pyrit√§√§n tekem√§√§n kaikki mahdollinen dplyr-paketin kanssa. dplyr:ista paljon lis√§√§ tuonnempana. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["r-markdown.html", "3 R Markdown", " 3 R Markdown T√§m√§kin ohjedokumentti, jota parhaillaan luet, on luotu R Markdown -merkint√§kielell√§. R Markdownilla kirjoitettu teksti on helposti luettavassa muodossa, ja voit edelleen k√§√§nt√§√§ sen yhdell√§ napin painalluksella loppumuotoon, joka voi olla jokin seuraavasta kolmesta: HTML (merkint√§kieli, jolla internet-sivut on kirjoitettu) PDF Microsoft Word -dokumentti T√§ss√§ ohjedokumentissa neuvotaan alusta asti opettelemaan datan analysointia ja ilmaisua nimenomaan R Markdownilla. R Markdownia on helppo kirjoittaa RStudio-nimisell√§ ilmaisella ohjelmalla. T√§m√§ sivu, jota parhaillaan luet, n√§ytt√§√§ R Markdownilla kirjoitettuna RStudiossa t√§lt√§ (katso kuva alla, menee hieman ‚Äúmetajutuksi‚Äù): R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["workflow-rll√§-ty√∂skennelless√§.html", "4 Workflow R:ll√§ ty√∂skennelless√§", " 4 Workflow R:ll√§ ty√∂skennelless√§ R:ll√§ ty√∂skennelless√§ workflow kulkee usein seuraavasti: tutkimusdata valmistellaan ‚Äúpaljailla‚Äù R-skripteill√§ tilastoajot tehd√§√§n sitten suoraan R Markdown -dokumentissa Workflow‚Äôn jako R-skripteihin ja R Markdown -dokumentteihin on toki t√§ysin vapaata ja yksil√∂llist√§ - toiset tekev√§t kaiken tai l√§hes kaiken suoraan R Markdown -dokumenteissa, toiset taas tekev√§t vain varsinaiset tilastoanalyysit ja visualisoinnit R Markdownin puolella. Voit kysell√§, ett√§ mit√§ hy√∂ty√§ on ajaa tilastoajot R Markdown -dokumentissa. Vastaan seuraavasti. Kuvittele tilannetta, jossa kirjoittaisit MS Wordilla kollegoillesi raporttia, jossa olisi tekstin ohella useita taulukoita ja kuvaajia. Jos tutkimusty√∂n ohjaajasi huomaisi jonkun virheen ja pyyt√§isi sinua korjaamaan dataasi, sinun pit√§isi korjausten j√§lkeen yksi kerrallaan ladata uudet taulukot ja kuvaajat MS Word -dokumenttiin. (Toim. huom.: ‚ÄúBeen there, done that‚Ä¶ üò≠‚Äù) R Markdown -dokumentissa t√§lle ei ole tarvetta: taulukot ja kuvaajat p√§ivittyv√§t automaattisesti, jos muutat jotakin datassasi. Halutessasi voit milloin vain sementoida R Markdownilla kirjoittamasi tekstin kuvaajineen valmiiksi ja jakaa sen vaikka juuri MS Word -muodossa kollegoillesi - tai PDF:n√§. Kolmas vaihtoehto on tehd√§ kuten tein t√§m√§n tekstin kanssa, jota juuri luet todenn√§k√∂isesti web-muodossa: p√§√§tin k√§√§nt√§√§ sen HTML:ksi, jotta sain tehty√§ t√§st√§ pikaoppaasta verkkosivut. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["asennus-tietokoneelle.html", "5 Asennus tietokoneelle 5.1 R-kielen asennus 5.2 RStudion asennus", " 5 Asennus tietokoneelle Sinun tulee asentaa Maciisi seuraavat kaksi asennuspakettia (jos niit√§ ei ole jo asennettu): R (asenna t√§m√§ ensin), ja RStudio. Kummankin asentaminen on superhelppoa, siit√§ lis√§√§ seuraavassa. 5.1 R-kielen asennus Mene ensin saitille https://cran.r-project.org/. Klikkaa kohtaan ‚ÄúDownload R for macOS‚Äù. Seuraavalla sivulla klikkaa ylimp√§√§n latauslinkkiin. Asenna latautuva paketti Maciisi. 5.2 RStudion asennus Asenna seuraavaksi RStudio koneellesi. Se tapahtuu seuraavasti: Mene osoitteeseen https://www.rstudio.com/products/rstudio/download/. Klikkaa Download-linkkiin ilmaisen ‚ÄúRStudio Desktop‚Äù kohdalla (katso kuva alla), asenna ohjelma Maciisi. Kun painat linkki√§, saitti heitt√§√§ sinun eteenp√§in sivulla (katso alla oleva kuva). Saitti muistuttaa, ett√§ R pit√§√§ olla asennettuna, mutta sen jo teitkin. Paina linkki√§ ‚ÄúDOWNLOAD RSTUDIO FOR MAC‚Äù, ja RStudio‚Ä¶ .dmg -niminen tiedosto siirtyy koneellesi, asenna siit√§ RStudio koneellesi. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["r-skriptit.html", "6 R-skriptit 6.1 RStudion perusn√§kym√§ 6.2 R-skriptin luonti 6.3 dplyr-paketin lataus", " 6 R-skriptit R-skriptit - eli R-ohjelmointikielt√§ sis√§lt√§v√§t tekstitiedostot - ovat luonteeltaan ihan samanlaisia kuin vaikkapa Base SASin vastaavat tekstitiedostot, eli ne sis√§lt√§v√§t yksinkertaisesti: R-ohjelmointikielell√§ koodia Koodin dokumentointia ‚Äì Huom! Muista dokumentoida runsaasti, jotta ymm√§rt√§isit omaa koodiasi pitk√§nkin ajan kuluttua! Dokumentointi tehd√§√§n R:ss√§ lis√§√§m√§ll√§ omien kommenttien eteen risuaita #. Alla esimerkki R-skriptist√§ (sinun ei tarvitse ajaa t√§t√§ itse): # Risuaidan j√§lkeen tuleva teksti ei ole koodia vaan omaa kommentointiasi. # Seuraavalla rivill√§ sen sijaan on oikeaa ohjelmointikielt√§: print(&quot;Hello world&quot;) Niin R-skriptej√§ kuin R Markdown -dokumenttejakin on k√§tev√§ tehd√§ RStudio-ohjelmalla, jota seuraavaksi k√§sittelemme. 6.1 RStudion perusn√§kym√§ RStudiossa on monenlaista n√§kym√§√§ ja painiketta, mutta tarvitset ihan aluksi vain kahta (katso kuva alla): Ikkunaa, johon kirjoitat R-skripti√§si (ns. source window) Console-ikkunaa 6.2 R-skriptin luonti Luo uusi R-skripti (tiedostop√§√§te .R) valitsemalla RStudion valikosta File ‚Äì&gt; New File ‚Äì&gt; R Script (katso kuva alla): Tallenna luomasi tyhj√§ R-skripti valitsemalla File ‚Äì&gt; Save as‚Ä¶ ja antamalla tiedoston nimeksi: minun_datani.R 6.3 dplyr-paketin lataus Datan k√§sittely√§ R:ss√§ helpottaa huomattavasti apupaketti dplyr. Asenna se heti aluksi tietokoneellesi seuraavasti (katso alla oleva kuva): klikkaa RStudion vasemmassa alakulmassa tabia Console. Kirjoita siin√§ n√§kyv√§n merkin &gt; per√§√§n seuraava k√§sky: install.packages(\"dplyr\") T√§m√§n j√§lkeen klikkaa takaisin RStudiossa dokumenttisi minun_datani.R puolelle. Kirjoita sen alkuun seuraava koodi, joka lataa dplyr-paketin t√§ss√§ projektissa k√§ytett√§v√§ksi: library(dplyr) Kun olet kirjoittanut yll√§ olevan rivin, mene jonnekin kyseisen rivin kohdalle ja paina Macissa n√§pp√§inyhdistelm√§√§ Cmd+Enter (Cmd on nelilehtisen apilan n√§k√∂inen nappula). N√§in tekem√§ll√§ olet juuri ajanut kyseisen rivin ja dplyr-paketin toiminnot ovat k√§ytett√§viss√§si. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["esimerkkidatasetti.html", "7 Esimerkkidatasetti 7.1 Datan muokkaus dplyr:illa 7.2 Kertausta dplyr:ista", " 7 Esimerkkidatasetti R:n opettelussa kannattaa hy√∂dynt√§√§ vapaasti k√§ytett√§viss√§ olevia esimerkkidatasettej√§. Valitaan Motor Trend Car Road Tests -niminen datasetti (lyhenne: mtcars), ja aletaan tarkastella ja k√§sitell√§ siin√§ olevia muuttujia. Luodaan ensin uusi oma datasettimme automobiilit, johon mtcars kopioidaan sellaisenaan (katso kuva alla): automobiilit &lt;- mtcars SASin k√§ytt√§j√§t ovat tottuneet t√§llaisessa datasetin luontitilanteessa n√§kem√§√§n uuden datasetin erityisess√§ SASin ikkunassa. RStudiossa saa ihan vastaavan ns. data view -n√§kym√§n aikaiseksi ajamalla vasemmalla alhaalla tabiss√§ Console seuraavan komennon: View(automobiilit) Kun olet kirjoittanut View(automobiilit)-k√§skyn, avautuu seuraava n√§kym√§ (kuva alla): Silm√§ile View-komennon aikaansaamaa data view -n√§kym√§√§. Havaitset biostatistikon n√§k√∂kulmasta seuraavat seikat: ‚ÄúKoehenkil√∂t‚Äù ovat t√§ss√§ tapauksessa automerkkej√§, ja ‚Äúbiomarkkereita‚Äù (muuttujia) ovat esim. hevosvoima, sylinterit jne. Huom! View()-komennon asemesta voit klikata hiiren vasemmalla napilla tarkasteltavan datasetin ‚ÄúValue‚Äù-sarakkeeseen, t√§m√§ tekee saman kuin View()-komento (katso kuva alla): 7.1 Datan muokkaus dplyr:illa Yksinkertaistetaan datasetti√§mme. S√§ilytet√§√§n vain seuraavat nelj√§ muuttujaa ja nimet√§√§n ne suomeksi: bensankulutusta kuvaava mpg, hevosvoimaa kuvaava hp, massa wt sek√§ vaihteistotyyppi am (automaattinen vs.¬†manuaalinen vaihteisto). T√§m√§n lis√§ksi harjoituksen vuoksi: Suljemme datasetist√§mme pois kaikki sellaiset autot, joissa ei ole k√§yt√∂ss√§ v√§hint√§√§n 2 karburaattoria. Huom! Jos et tied√§ mik√§ on karburaattori, t√§ll√§ ei ole mit√§√§n v√§li√§. Yht√§ hyvin t√§m√§ voisi olla ‚Äúoltava enemm√§n kuin yksi munuainen tutkittavalla potilaalla‚Äù jossakin toisessa datasetiss√§. dplyr-paketin komennoilla yll√§ mainittujen asioiden toteuttaminen on eritt√§in helppoa. Kirjoita seuraavat rivit R-skriptiisi minun_datani.R. Voit copy-pastettaa ne suoraan t√§st√§ alta, jos luet t√§m√§n pikaohjeen elektronista versiota. Huom. katso my√∂s kuva alempana: automobiilit2 &lt;- automobiilit %&gt;% #Otetaan k√§sitelt√§v√§ksi datasetti automobiilit filter(carb &gt; 1) %&gt;% #S√§ilytet√§√§n vain autot, joissa yli 1 karburaattori mutate(bensankulutus = mpg, #Luodaan uusia suomenkielisi√§ hevosvoima = hp, #muuttujia n√§ill√§ nelj√§ll√§ rivill√§; massa = wt, #k√§yt√§nn√∂ss√§ luodaan englanninkielisist√§ vaihteisto = am) %&gt;% #valmiista muuttujista duplikaatteja select(bensankulutus, #Pidet√§√§n luomamme muuttujat, tuhotaan kaikki muut hevosvoima, massa, vaihteisto) Aja sy√∂tt√§m√§si rivit: voit joko maalata hiirell√§ koko rimpsun ja ajaa sen n√§pp√§inyhdistelm√§ll√§ Command+Enter tai menn√§ vain kyseisen rivist√∂n ensimm√§iselle riville ja painaa Command+Enter. Tarkastele luomaasi datasetti√§ t√§m√§n j√§lkeen ajamalla konsolissa View-komento, t√§ll√§ kertaa uudesta datasetist√§ automobiilit2: View(automobiilit2) Huomaat, ett√§ ajamasi koodi on toiminut toivotulla tavalla (katso kuva alla). 7.2 Kertausta dplyr:ista dplyr:ia k√§ytett√§ess√§ erilaiset k√§skyt (yll√§: filter, mutate sek√§ select) sy√∂tet√§√§n ‚Äúputkea‚Äù pitkin per√§kanaa tapahtuvaksi sijoittamalla kunkin k√§skyn v√§liin aina seuraava operaattori (eli merkkikombinaatio): %&gt;%. Viel√§ kertauksena dplyr:ll√§ tehdyn k√§skyputken toiminta (katso my√∂s kuva alla): filter: suljetaan datastamme jotain pois (t√§ss√§ esimerkiss√§ suljimme pois autot, joissa on alle 2 karburaattoria). mutate: luodaan uusia muuttujia select: s√§ilytet√§√§n muuttujat jotka mainitaan, kaikki muut tuhotaan %&gt;%-operaattori: t√§m√§n kanssa putkitetaan k√§skyt yksi kerrallaan per√§kanaa tapahtuviksi &lt;--operaattori: t√§ll√§ tallennetaan putkesta ulos tuleva data uuteen datasettiin Pelk√§st√§√§n n√§iden muutaman toiminnon osaaminen mahdollistaa jo monimutkaisenkin datasetin kasaamisen tutkimustasi varten. Ei tarvitse tankata k√§skyj√§ ulkoa; voit alkuun kopioida esim. t√§st√§ ohjeesta n√§it√§ itsellesi, ja netist√§ l√∂yt√§√§ valtavasti lis√§esimerkkej√§. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["puutteellista-dataa.html", "8 Puutteellista dataa? 8.1 Puutteellisen datan poisto", " 8 Puutteellista dataa? Tieteellisten artikkelien Methods-osuudessa useimmiten kuvataan, ett√§ ennen analyysej√§ suljettiin pois kaikki sellaiset tutkittavat, joiden kohdalla oli puuttuvaa dataa jonkun tutkittavan biomarkkerin suhteen. Harjoitellaan seuraavassa viel√§ t√§t√§. Luodaan itse pari autoa dplyr:in k√§skyill√§ datasettiimme, mutta tehd√§√§n t√§m√§ niin, ett√§ n√§iss√§ kahdessa autossa on puuttuvaa dataa. (Huom! Sinun ei tarvitse t√§ss√§ vaiheessa opetella datarivin lis√§√§mist√§ tai rivin nimen muuttamista seuraavasta koodista - riitt√§√§ kun kopioit koodit omaan skriptiisi minun_datani.R.) # 1. # # Luodaan auto, jolle ei m√§√§ritet√§ massaa. # Massa saa automaattisesti R:ss√§ siksi arvon NA (not available eli missing data). # Tallennetaan koko uusi automobiilisetti datasettiin &quot;automobiilit3&quot;: automobiilit3 &lt;- automobiilit2 %&gt;% add_row(bensankulutus = 30.7, hevosvoima = 67, vaihteisto = 1) #Annetaan viimeisen rivin (eli auton) nimeksi &quot;Lada&quot;: row.names(automobiilit3)[nrow(automobiilit3)] &lt;- &quot;–õ–∞–¥–∞&quot; # 2. # # Luodaan seuraava auto, joka saa DDR:n historiaa henkiv√§n nimen &quot;Trabant&quot;. # Annetaan massaksi selv√§sti virheellinen arvo 0 kiloa. # Tallennetaan koko automobiilisetti datasetin &quot;automobiili3&quot; p√§√§lle: automobiilit3 &lt;- automobiilit3 %&gt;% add_row(bensankulutus = 34.6, hevosvoima = 23, massa = 0, vaihteisto = 1) row.names(automobiilit3)[nrow(automobiilit3)] &lt;- &quot;Trabant&quot; Voit tarkastella luotua dataa j√§lleen kirjoittamalla konsoliin k√§skyn: View(automobiilit3) N√§et autojen listan lopussa kaksi uutta rivi√§, joilla on puuttuvaa/virheellist√§ dataa sarakkeessa ‚Äúmassa‚Äù (t√§ss√§ n√§kyy vain 6 viimeist√§ rivi√§): bensankulutus hevosvoima massa vaihteisto Ford Pantera L 15.8 264 3.17 1 Ferrari Dino 19.7 175 2.77 1 Maserati Bora 15.0 335 3.57 1 Volvo 142E 21.4 109 2.78 1 –õ–∞–¥–∞ 30.7 67 NA 1 Trabant 34.6 23 0.00 1 8.1 Puutteellisen datan poisto Virheellist√§ dataa voi poistaa seuraavin vaihein: vaihe: NA-arvoja (not available) sis√§lt√§vien rivien poisto vaihe: ep√§adekvaattia dataa sis√§lt√§vien rivien poisto (esim. massa ei voi olla 0 kg) K√§yt√§nn√∂ss√§ vaiheen 2 toteutus vie my√∂s kohdassa yksi mainitut NA-arvoa sis√§lt√§v√§t rivit menness√§√§n, kun k√§ytet√§√§n dplyr-paketin filter-k√§sky√§, joka tuli jo edell√§ tutuksi. Demonstroidaan t√§m√§ seuraavilla koodiriveill√§ (voit kirjoittaa n√§m√§ minun_datani.R-skriptiin ja ajaa siin√§ painamalla Cmd+Enter): # 1. vaihe: # # N√§ytet√§√§n datamme, kun NA&#39;ta sis√§lt√§neet rivit on poistettu. # Huom! Uutta datasetti√§ ei luoda, sill√§ emme k√§ske dataa # operaattorilla &lt;- siirrett√§v√§ksi mihink√§√§n uuteen datasettiin. # Eli seuraava koodi vain ik√§√§n kuin n√§ytt√§√§ mink√§lainen datasetti # meille tulisi, jos ohjaisimme koodin eteenp√§in uuteen datasettiin # k√§ytt√§m√§ll√§ operaattoria &lt;- ja antamalla uudelle datasetille jonkun # nimen, esim. &quot;automobiilit4&quot;: automobiilit3 %&gt;% na.omit Kuten alla n√§et (tulostettuna vain 6 viimeist√§ rivi√§), NA-arvoa sis√§lt√§nyt Lada h√§vi√§isi, mutta Trabant j√§isi j√§ljelle: ## bensankulutus hevosvoima massa vaihteisto ## Lotus Europa 30.4 113 1.513 1 ## Ford Pantera L 15.8 264 3.170 1 ## Ferrari Dino 19.7 175 2.770 1 ## Maserati Bora 15.0 335 3.570 1 ## Volvo 142E 21.4 109 2.780 1 ## Trabant 34.6 23 0.000 1 Kokeillaan nyt vaihetta 2 eli poistaa muuttujat, jotka eiv√§t saa jotakin j√§rjellist√§ arvoa, ja katsotaan miten k√§y. Huom! Taaskaan emme tallenna t√§t√§ ajoa mihink√§√§n uuteen datasettiin, koska emme k√§yt√§ operaattoria &lt;- piiputettujen k√§skyjen alussa (tai lopussa). Voit kirjoittaa seuraavat rivit minun_datani.R-skriptiin ja ajaa siin√§ painamalla Cmd+Enter: # 2. vaihe: # # S√§ilytet√§√§n vain autot, joiden muuttujat saavat &quot;sallittuja&quot;, j√§rjellisi√§ arvoja. # J√§lleen: emme tee uutta datasetti√§ vaan ainoastaan demonstroimme mink√§lainen datasetti # tulisi, jos loisimme t√§ss√§ uuden datasetin. automobiilit3 %&gt;% filter(bensankulutus &gt; 0, hevosvoima &gt; 0, massa &gt; 0, vaihteisto %in% c(0,1)) Huomaat, ett√§ vaiheen 2 k√§sky vie suoraan sek√§ NA‚Äôta sis√§lt√§neen Ladan ett√§ ‚Äúnollamassan‚Äù sis√§lt√§neen Trabantin menness√§√§n (t√§ss√§ alla n√§ytettyn√§ vain 4 viimeist√§ rivi√§ tulosteesta): ## bensankulutus hevosvoima massa vaihteisto ## Ford Pantera L 15.8 264 3.17 1 ## Ferrari Dino 19.7 175 2.77 1 ## Maserati Bora 15.0 335 3.57 1 ## Volvo 142E 21.4 109 2.78 1 Jos ja kun k√§yt√§mme dplyr:n filter-komentoa, strategiamme on: Valitsemme ylt√§ suoraan vaiheen 2 filter-k√§skyn, joka poistaa sek√§ NA:t ett√§ ‚Äúnollamassat‚Äù Luodaan samalla uusi, vain adekvaattia dataa sis√§lt√§v√§ datasetti ‚Äúautomobiilit4‚Äù. Kirjoita seuraavat rivit minun_datani.R-skriptiin ja aja siin√§ painamalla Cmd+Enter: # Poistetaan rivit joilla ep√§adekvaattia dataa tai NA:ta. # Tallennetaan t√§llainen koko automobiilisetti # uuteen datasettiin &quot;automobiilit4&quot;: automobiilit4 &lt;- automobiilit3 %&gt;% filter(bensankulutus &gt; 0, hevosvoima &gt; 0, massa &gt; 0, vaihteisto %in% c(0,1)) Kun tarkastelet datasetti√§ kirjoittamalla konsoliin k√§skyn View(automobiilit4) huomaat, ett√§ datasetti on nyt siistitty puuttuvasta/virheellisest√§ datasta (alla n√§kyy vain 4 viimeist√§ rivi√§): bensankulutus hevosvoima massa vaihteisto Ford Pantera L 15.8 264 3.17 1 Ferrari Dino 19.7 175 2.77 1 Maserati Bora 15.0 335 3.57 1 Volvo 142E 21.4 109 2.78 1 R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["datasettien-tuhoaminen.html", "9 Datasettien tuhoaminen", " 9 Datasettien tuhoaminen Kun kirjoitat konsoliin ls(), n√§et kaikki R:n muistiin tallentamat datasetit - tai R:n tapauksessa puhutaan paremminkin objekteista. Listaus n√§ytt√§√§ suurinpiirtein seuraavalta: [1] &quot;automobiilit&quot; &quot;automobiilit2&quot; &quot;automobiilit3&quot; &quot;automobiilit4&quot; Vaihtoehtoisesti voit tarkastella listausta objekteista RStudion tietyss√§ v√§lilehdess√§, katso kuva alla: Tuhotaan harjoituksen vuoksi kaikki muut paitsi datasetti ‚Äúautomobiilit‚Äù seuraavalla k√§skyll√§, jonka voit kirjoittaa vaikka suoraan konsoliin: rm(automobiilit2, automobiilit3, automobiilit4) Kun ajat uudelleen k√§skyn ls() konsolissa, n√§et vain datasetin ‚Äúautomobiilit‚Äù: [1] &quot;automobiilit&quot; Good to know: k√§sky rm(list = ls()) tuhoaa kaikki objektit R-session muistista (putsaa koko session tyhj√§ksi). Good to know II: osa kokeneista R:n k√§ytt√§jist√§ ei tuhoa mit√§√§n koskaan, mutta resetoi silloin t√§ll√∂in R:n ja aloittaa puhtaalta p√∂yd√§lt√§. T√§m√§ tapahtuu valitsemalla RStudion yl√§valikosta ‚ÄúSession‚Äù -&gt; ‚ÄúRestart R‚Äù R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["muunnosmuuttujat.html", "10 Muunnosmuuttujat", " 10 Muunnosmuuttujat Biostatistikot kutsuvat muunnosmuuttujiksi sellaisia uusia muuttujia, jotka on muodostettu jonkun yksitt√§isen tai useamman alkuper√§isess√§ datasetiss√§ olevan muuttujan pohjalta. Esimerkki voisi olla esim. uusi muuttuja nimelt√§√§n verenpainetauti, joka saisi arvon 1, jos tutkittavan toimistoverenpaine olisi 140/90 mmHg tai yli tai jos tutkittava k√§ytt√§isi verenpainel√§√§kityst√§, mutta muussa tapauksessa arvon 0. K√§yt√§nn√∂ss√§ jo yll√§ teimme t√§llaisia muunnosmuuttujia k√§skyll√§ mutate, mutta ainoana uutena asiana loimme suomenkielisen nimen alkuper√§isille muuttujille. Harjoituksen vuoksi muuttakaamme datasetiss√§mme olevat amerikkalaiset yksik√∂t eurooppalaisempaan muotoon. Tarkastele esimerkkin√§ k√§ytt√§m√§mme datasetin mtcars taustoja pyyt√§m√§ll√§ lis√§tietoa siit√§ seuraavalla komennolla (voit ajaa sen joko Consolessa tai sitten R-skriptiss√§si): ?mtcars RStudion oikeaan alalaitaan tulee v√§lisivuun ‚ÄúHelp‚Äù n√§kyviin jokseenkin seuraavaa sis√§lt√∂√§ (t√§ss√§ n√§kyy siit√§ muutamia rivej√§): mtcars {datasets} R Documentation Motor Trend Car Road Tests Description The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973‚Äì74 models). Usage mtcars Format A data frame with 32 observations on 11 (numeric) variables. [, 1] mpg Miles/(US) gallon [, 2] cyl Number of cylinders [, 3] disp Displacement (cu.in.) [, 4] hp Gross horsepower Help-n√§kym√§st√§ huomaa, ett√§ datasetti mtcars sis√§lt√§√§ dataa, joka on sy√∂tetty sis√§√§n amerikkalaisissa yksik√∂iss√§ (maileja, gallonoita, hp-tyyppist√§ hevosvoimaa jne.). Tahdomme seuraavaksi muuttaa amerikkalaiset yksik√∂t eurooppalaisiksi. Avoimella internethaulla selvitin seuraavaa: eurooppalainen bensankulutus (l/100 km) = 235.2 / amerikkalainen kulutus (mpg) eurooppalainen hevosvoima (PS) = amerikkalainen hevosvoima (hp) / 0.9863 eurooppalainen massa (kg) = auton amerikkalainen massalukema (ilmaistu yksik√∂ss√§: 1000 lbs) * 453.6 Ajetaan edell√§ kappaleessa 7 jo ajettu koodi uudemman kerran, mutta muutetaan t√§ll√§ kertaa yksik√∂t eurooppalaisiksi. Tallennetaan tulokset uuteen datasettiin ‚Äúautoja‚Äù: # L√§hdet√§√§n alusta liikkeelle: otetaan mtcars k√§sitelt√§v√§ksi. # Huom. Vasta Kun kaikki putkitetut komennot alla on ajettu l√§pi, # datasetti tallentuu uuteen &quot;autoja&quot;-nimiseen datasettiin. autoja &lt;- mtcars %&gt;% # Valitaan vain yli 1 karburaattoria sis√§lt√§v√§t autot. filter(carb &gt; 1) %&gt;% # Muutetaan mutate-k√§skyll√§ jenkkiyksik√∂t eurooppalaisiksi # ja annetaan muuttujille samalla suomalaisia nimi√§. mutate(bensankulutus_eu = 235.2 / mpg, hevosvoima_eu = hp / 0.9863, massa_eu = wt * 453.6, vaihteisto = am) %&gt;% # Select-k√§skyll√§ s√§ilytet√§√§n vain luomamme uudet muuttujat ja # samalla tulee tuhotuksi kaikki muut muuttujat. select(bensankulutus_eu, hevosvoima_eu, massa_eu, vaihteisto) Tarkastele nyt dataasi kirjoittamalla konsoliin: View(autoja) Nyt autojen ‚Äúbiomarkkerit‚Äù n√§ytt√§v√§t tutummilta suomalaisenkin silm√§√§n (alla n√§ytettyn√§ 4 ensimm√§ist√§ rivi√§): bensankulutus_eu hevosvoima_eu massa_eu vaihteisto Mazda RX4 11.20000 111.5279 1188.432 1 Mazda RX4 Wag 11.20000 111.5279 1304.100 1 Hornet Sportabout 12.57754 177.4308 1560.384 0 Duster 360 16.44755 248.4031 1619.352 0 R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["kategoriset-muuttujat.html", "11 Kategoriset muuttujat 11.1 as.factor-k√§sky 11.2 tibble", " 11 Kategoriset muuttujat Esimerkiksi bensankulutusta (tai tutkimuspotilaan pituutta) jatkuvalla asteikolla kuvaava muuttuja on jatkuva muuttuja. Sen sijaan edell√§ kappaleessa 9 esiteltiin hypoteettinen muuttuja verenpainetauti, joka sai joko arvon 0 tai 1; t√§llainen muuttuja ei olisi jatkuva vaan kategorinen muuttuja. Viel√§ spesifisemmin t√§llaisia dikotomisia (useimmiten joko arvon 0 tai 1 saavia) muuttujia kutsutaan dummy-muuttujiksi. On mielest√§ni viisasta kertoa R:lle, mitk√§ muuttujistasi ovat kategorisia muuttujia, jotta R ei erehdy k√§sittelem√§√§n niit√§ miss√§√§n analyyseiss√§ jatkuvina muuttujina. R:ss√§ kategoriset muuttujat kannattaa tallentaa factor-tyyppisen√§. T√§m√§ on eritt√§in helppoa. Voit katsella dataasi kirjoittamalla Consoleen seuraavan k√§skyn: autoja Pikainenkin silm√§ys tulosteeseen (vain 4 rivi√§ t√§ss√§ alla) paljastaa sinulle, ett√§ muuttuja vaihteisto on t√§ss√§ datassa tarkoitettu kategoriseksi muuttujaksi. Muut muuttujat taas ovat selv√§sti jatkuvia muuttujia. ## bensankulutus_eu hevosvoima_eu massa_eu vaihteisto ## Mazda RX4 11.20000 111.5279 1188.432 1 ## Mazda RX4 Wag 11.20000 111.5279 1304.100 1 ## Hornet Sportabout 12.57754 177.4308 1560.384 0 ## Duster 360 16.44755 248.4031 1619.352 0 11.1 as.factor-k√§sky Muutetaan muuttuja vaihteisto muotoon factor eli kategoriseksi muuttujaksi ja tallennetaan tulos ‚Äúitsens√§ p√§√§lle‚Äù eik√§ siis luoda uutta datasetti√§ vaikkapa nimell√§ ‚Äúautoja2‚Äù. T√§h√§n on pari helppoa tapaa. vaihtoehto: Base-R:ll√§ teht√§isiin seuraavasti: autoja$vaihteisto &lt;- as.factor(autoja$vaihteisto) Huomaa, ett√§ dollarimerkill√§ varustetulla ilmaisulla autoja$vaihteisto ilmoitamme, ett√§ tahdomme muuttaa datasetist√§ autoja ainoastaan muuttujan vaihteisto muotoon factor. vaihtoehto on tehd√§ sama asia dplyria hy√∂dynt√§en: autoja &lt;- autoja %&gt;% mutate(vaihteisto = as.factor(vaihteisto)) Aja jompi kumpi yll√§ mainituista tavoista. Jos nyt katselet dataasi uudelleen kirjoittamalla Consoleen seuraavan k√§skyn, mit√§√§n eroa entiseen ei kuitenkaan n√§e (t√§ss√§ n√§ytettyn√§ vain 4 rivi√§): autoja ## bensankulutus_eu hevosvoima_eu massa_eu vaihteisto ## Mazda RX4 11.20000 111.5279 1188.432 1 ## Mazda RX4 Wag 11.20000 111.5279 1304.100 1 ## Hornet Sportabout 12.57754 177.4308 1560.384 0 ## Duster 360 16.44755 248.4031 1619.352 0 Onkin ongelmallista, ettet n√§e kyseisess√§ tulosteessa, ett√§ tiet√§√§k√∂ R kunkin muuttujan kohdalla ett√§ onko kyseess√§ jatkuva vaiko kategorinen muuttuja. Apuun tulee tibble, joka on paranneltu versio karvalakki-R:n ‚Äúdatakehyksest√§‚Äù (aiemmissa esimerkeiss√§ ‚Äúautomobiilit‚Äù, ‚Äúautomobiilit2‚Äù jne. olivat t√§ss√§ karvalakkimuodossa). Sinun ei t√§ss√§ vaiheessa tarvitse ymm√§rt√§√§ mit√§√§n datakehyksist√§ tai miksi tibble on parempi muoto - just take my word for it. 11.2 tibble Muutetaan seuraavassa datasettimme ‚Äúautoja‚Äù muotoon tibble. Tallennetaan uusi datasetti nimell√§ ‚Äúautoja2‚Äù. Teemme samalla toisen t√§rke√§n korjauksen. T√§h√§n menness√§ datasettimme rivit on nimetty automerkkien mukaan, mutta rivien nime√§minen ylip√§√§ns√§ ei ole t√§n√§ p√§iv√§n√§ suositeltavaa. Kun siirrymme tibble-muotoon, rivinimet tuhoutuvat ja tilalle tulevat rivinumerot. Automerkit (tai analogisesti: ‚Äútutkittavien kooditunnisteet‚Äù) n√§kyv√§t seuraavan k√§skyn j√§lkeen ensimm√§isess√§ sarakkeessa, mik√§ on suositellumpaa. Se k√§y n√§in - ja huomaa, ett√§ k√§sky on as_tibble eik√§ as.tibble: autoja2 &lt;- as_tibble(autoja, rownames = &quot;Automerkit&quot;) Kun t√§m√§n j√§lkeen kirjoitat konsoliin seuraavan k√§skyn, voit helposti havaita, ett√§ R todella tiet√§√§, ett√§ muuttuja vaihteisto on kategorinen (eli R:n muodossa factor): autoja2 Alla n√§kyy 4 rivi√§ datasta (katso my√∂s kuva alla): ## # A tibble: 4 x 5 ## Automerkit bensankulutus_eu hevosvoima_eu massa_eu vaihteisto ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; ## 1 Mazda RX4 11.2 112. 1188. 1 ## 2 Mazda RX4 Wag 11.2 112. 1304. 1 ## 3 Hornet Sportabout 12.6 177. 1560. 0 ## 4 Duster 360 16.4 248. 1619. 0 R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["koko-valmis-esimerkkidata.html", "12 Koko valmis esimerkkidata", " 12 Koko valmis esimerkkidata Alla n√§et jokseenkin kaiken ty√∂st√§m√§mme esimerkkidatan per√§kanaa esitettyn√§. Seuraavassa kappaleessa tulemme ty√∂st√§m√§√§n analyysej√§ t√§st√§ datasta R Markdown -dokumentissa. Jos tipuit jossain vaiheessa k√§rryilt√§, voit copy-pastettaa koko esimerkkidatan alta RStudioon seuraavasti: RStudiossa yl√§valikosta File ‚Äì&gt; New File ‚Äì&gt; R Script, pastetus tuohon skriptiin ja talletus (Save As‚Ä¶) R-skriptiksi nimell√§ minun_datani.R. minun_datani.R tullaan lataamaan R Markdown -dokumenttimme source- eli l√§hdetiedostoksi seuraavassa kappaleessa. Huom! Jos et copy-pasteta rivej√§ t√§st√§ alta, tarkasta viel√§ ennen kuin siirryt seuraavaan kappaleeseen, ettei R-skriptiss√§si minun_datani.R ole miss√§√§n kohtaa View()-komentoja, sill√§ ne sotkevat R Markdown -dokumentin k√§√§ntymisvaihetta jatkossa. Alla olevassa tekstiss√§ View()-komentoja ei ole, olen t√§m√§n tarkastanut. # Copy-pasteta kaikki alla oleva ja tallenna se R-skriptiin nimelt√§ minun_datani.R ################################################################## ## Kappale 6.3: ## ## dplyr-paketin lataus ## ################################################################## # Ladataan muistiin dplyr-paketti. library(dplyr) ################################################################## ## Kappaleet 7 ja 7.1 ## ## Esimerkkidatasetti ## ## Datan muokkaus dplyr:lla ## ################################################################## # Kopioidaan R:n esimerkkidatan &quot;mtcars&quot; sis√§lt√∂ # uuteen datasettiin &quot;automobiilit&quot;. automobiilit &lt;- mtcars # Otetaan k√§sitelt√§v√§ksi datasettimme &quot;automobiilit&quot;. automobiilit2 &lt;- automobiilit %&gt;% # S√§ilytet√§√§n vain autot, joissa yli 1 karburaattori: filter(carb &gt; 1) %&gt;% # Luodaan uusia suomenkielisi√§ muuttujia (oikeastaan # duplikaatteja jo englanniksi olevista muuuttujista). mutate(bensankulutus = mpg, hevosvoima = hp, massa = wt, vaihteisto = am) %&gt;% #Pidet√§√§n luomamme muuttujat, tuhotaan kaikki muut select(bensankulutus, hevosvoima, massa, vaihteisto) ################################################################## ## Kappaleet 8 ja 8.1 ## ## Puutteellista dataa? ## ## Puutteellisen datan poisto ## ################################################################## # 1. # # Luodaan auto, jolle ei m√§√§ritet√§ massaa. # Massa saa automaattisesti R:ss√§ siksi arvon NA (not available eli missing data). # Tallennetaan koko uusi automobiilisetti datasettiin &quot;automobiilit3&quot;: automobiilit3 &lt;- automobiilit2 %&gt;% add_row(bensankulutus = 30.7, hevosvoima = 67, vaihteisto = 1) #Annetaan viimeisen rivin (eli auton) nimeksi &quot;Lada&quot;: row.names(automobiilit3)[nrow(automobiilit3)] &lt;- &quot;–õ–∞–¥–∞&quot; # 2. # # Luodaan seuraava auto, joka saa DDR:n historiaa henkiv√§n nimen &quot;Trabant&quot;. # Annetaan massaksi selv√§sti virheellinen arvo 0 kiloa. # Tallennetaan koko automobiilisetti datasetin &quot;automobiili3&quot; p√§√§lle: automobiilit3 &lt;- automobiilit3 %&gt;% add_row(bensankulutus = 34.6, hevosvoima = 23, massa = 0, vaihteisto = 1) row.names(automobiilit3)[nrow(automobiilit3)] &lt;- &quot;Trabant&quot; # N√§ytet√§√§n datamme, kun NA&#39;ta sis√§lt√§neet rivit on poistettu. # Huom! Uutta datasetti√§ ei luoda, sill√§ emme k√§ske dataa # operaattorilla &lt;- siirrett√§v√§ksi mihink√§√§n uuteen datasettiin. # Eli seuraava koodi vain ik√§√§n kuin n√§ytt√§√§ mink√§lainen datasetti # meille tulisi, jos ohjaisimme koodin eteenp√§in uuteen datasettiin # k√§ytt√§m√§ll√§ operaattoria &lt;- ja antamalla uudelle datasetille jonkun # nimen, esim. &quot;automobiilit4&quot;: automobiilit3 %&gt;% na.omit # S√§ilytet√§√§n vain autot, joiden muuttujat saavat &quot;sallittuja&quot;, j√§rjellisi√§ arvoja. # J√§lleen: emme tee uutta datasetti√§ vaan ainoastaan demonstroimme mink√§lainen datasetti # tulisi, jos loisimme t√§ss√§ uuden datasetin. automobiilit3 %&gt;% filter(bensankulutus &gt; 0, hevosvoima &gt; 0, massa &gt; 0, vaihteisto %in% c(0,1)) # Poistetaan rivit joilla ep√§adekvaattia dataa tai NA:ta. # Tallennetaan t√§llainen koko automobiilisetti # uuteen datasettiin &quot;automobiilit4&quot;: automobiilit4 &lt;- automobiilit3 %&gt;% filter(bensankulutus &gt; 0, hevosvoima &gt; 0, massa &gt; 0, vaihteisto %in% c(0,1)) ################################################################## ## Kappale 10 ## ## Muunnosmuuttujat ## ################################################################## # Ajetaan putkittamalla eli %&gt;%-merkkikomboa k√§ytt√§m√§ll√§ kaikki # seuraavat 4 kohtaa kerralla: # 1. L√§hdet√§√§n uudelleen alusta liikkeelle, otetaan mtcars k√§sitelt√§v√§ksi. autoja &lt;- mtcars %&gt;% # 2. Valitaan vain yli 1 karburaattoria sis√§lt√§v√§t autot. filter(carb &gt; 1) %&gt;% # 3. Muutetaan mutate-k√§skyll√§ jenkkiyksik√∂t eurooppalaisiksi # ja annetaan muuttujille samalla suomalaisia nimi√§. mutate(bensankulutus_eu = 235.2 / mpg, hevosvoima_eu = hp / 0.9863, massa_eu = wt * 453.6, vaihteisto = am) %&gt;% # 4. Select-k√§skyll√§ s√§ilytet√§√§n vain luomamme uudet muuttujat ja # samalla tulee tuhotuksi kaikki muut muuttujat. select(bensankulutus_eu, hevosvoima_eu, massa_eu, vaihteisto) ################################################################# ## Kappale 11.1 ## ## as.factor-k√§sky ## ################################################################# # Muutetaan muuttuja &quot;autoja$vaihteisto&quot; eli datasetin &quot;autoja&quot; muuttuja # &quot;vaihteisto&quot; muotoon factor. # Tallennetaan se itsens√§ p√§√§lle. autoja$vaihteisto &lt;- as.factor(autoja$vaihteisto) # T√§ysin sama asia olisi voitu tehd√§ dplyr-tyyppisell√§ k√§skyll√§: #autoja &lt;- autoja %&gt;% mutate(vaihteisto = as.factor(vaihteisto)) ################################################################## ## Kappale 11.2 ## ## tibble ## ################################################################## # Muutetaan datasettimme muotoon tibble. # Rivinimet tuhoutuvat, mutta ne voidaan t√§st√§ # eteenp√§in n√§hd√§ ensimm√§isess√§ sarakkeessa. autoja2 &lt;- as_tibble(autoja, rownames = &quot;Automerkit&quot;) R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["r-markdownin-luonti.html", "13 R Markdownin luonti 13.1 K√§√§nt√∂ lopputuotokseksi 13.2 YAML-otsikko 13.3 R Markdownilla kirjoittaminen 13.4 ‚ÄúChunkit‚Äù 13.5 Ensimm√§inen chunk", " 13 R Markdownin luonti Luo R Markdown -tiedosto (tiedostop√§√§te .Rmd) valitsemalla RStudion valikosta File ‚Äì&gt; New File ‚Äì&gt; R Markdown (katso kuva alla). Seuraavaksi tulee valikko, josta voit valita, oletko ty√∂st√§m√§ss√§ loppupeleiss√§ verkkosivua (eli HTML-muotoista tiedostoa), PDF:√§√§ vaiko Word-tiedostoa. Ohjelma ehdottaa sinulle HTML-tyyppist√§ julkaisua - hyv√§ksy t√§m√§ ehdotus valitsemalla OK. T√§ten tulee luoduksi uusi .Rmd-tiedosto, jonka osiot ovat seuraavat (katso my√∂s kuva alla): YAML-otsikko aivan dokumenttisi alussa: sis√§lt√§√§ asetuksia kuten valitsemasti ty√∂stett√§v√§n loppumuodon (HTML- vs.¬†PDF- vs.¬†Word-tiedosto) Markdown-tyyppinen vapaa tekstisi (esim. juuri nyt lukemasi tekstin olen sellaisella kirjoittanut) Erityiset koodi-‚Äúchunkit‚Äù, jotka voivat sis√§lt√§√§ R:n ja muutamien muidenkin ohjelmointikielien koodia 13.1 K√§√§nt√∂ lopputuotokseksi RStudio loi sinulle R Markdown -tiedoston sabluunan, jossa on jo jonkin verran sis√§lt√∂√§. Voit samantien k√§√§nt√§√§ dokumentin valmiiksi lopputuotokseksi. Tee seuraavasti: Tallenna ensin tiedostosi valitsemalla File ‚Äì&gt; Save as‚Ä¶ ja antamalla nimeksi esim: testailen_rmarkdownia.Rmd Paina sitten painiketta ‚ÄúKnit‚Äù tekstisi yl√§puolella (katso kuva alla) T√§ll√∂in RStudion oma web-selain avautuu, ja n√§et juuri k√§√§nt√§m√§si R Markdown -dokumentin lopputuloksen HTML-muodossa (eli ik√§√§n kuin ‚Äúweb-sivuina‚Äù). Jos kaikki meni ok, n√§et alla olevan n√§kym√§n: 13.2 YAML-otsikko YAML-otsikko on eristetty muusta dokumentista kahden ----tyyppisen viivarivin v√§liin. Jos olet aloittelija, sinun ei tarvitse koskea YAML-osioon ollenkaan. Voit aloittaa R Markdownin k√§yt√∂n suoraan sill√§ YAML-otsikolla, jonka RStudio sinulle loi, kun valitsit RStudion valikosta File ‚Äì&gt; New File ‚Äì&gt; R Markdown. Jos kuitenkin olet innostunut kokeilemaan YAML:nkin s√§√§t√∂√§, voit perehty√§ online-ohjeisiin esim. kirjassa R Markdown: The Definitive Guide. Saat helposti kyseisen sivun ohjeiden kanssa lis√§tty√§ dokumenttiisi esim. nimesi ja p√§iv√§m√§√§r√§n. 13.3 R Markdownilla kirjoittaminen Itse R Markdown -koodi on pitk√§lti ihan tavallista teksti√§ - aivan kuin kirjoittaisi Wordilla, Notepadilla jne. Lihavoidun tekstin saat aikaiseksi laittamalla tekstikohdan ymp√§rille kaksi asteriskia: **Lihavoidun tekstin**. Kursivoidun tekstin saat aikaiseksi laittamalla vain yhden asteriskin kummallekin puolelle teksti√§: *Kursivoidun tekstin*. 13.4 ‚ÄúChunkit‚Äù Chunkeissa ajetaan analyysej√§, tehd√§√§n taulukoita ja piirret√§√§n kuvia R-koodilla. Jokaisella chunkilla pit√§√§ olla oma yksil√∂llinen otsikkonsa, jonka keksit p√§√§st√§; jos k√§yt√§t kahdessa eri chunkissa samaa otsikkoa, R heitt√§√§ sinulle herjan kun yrit√§t k√§√§nt√§√§ dokumenttia nappulalla ‚ÄúKnit‚Äù. Chunkit erotellaan vapaasta tekstist√§ - siis markdown-osiosta - kirjoittamalla kolme gravisaksenttia sek√§ ennen ett√§ j√§lkeen koodin. Gravisaksentti on erityisen tuttu ranskaa lukeneille. Jos et tied√§, miten n√§pp√§imist√∂st√§ saa gravisaksentteja ulos, voit aina copy-pastettaa niit√§ vaikkapa t√§st√§ pikaoppaasta, jota olet lukemassa. Alla esimerkki toimivasta chunkista: ```{r bensankulutus, echo=FALSE} plot(autoja2$hevosvoima, autoja2$bensankulutus) ``` Kun mukana on yll√§ n√§kyv√§ echo=FALSE, n√§hd√§√§n k√§skyn plot(autoja2$hevosvoima, autoja2$bensankulutus) aikaansaama tuloste mutta ei itse koodia plot(autoja2$hevosvoima, autoja2$bensankulutus), kun R Markdown -dokumenttimme k√§√§nnet√§√§n lopputuotokseksi. Tarkempia tietoja siit√§, miten s√§√§telet optiolla echo sit√§ mit√§ lopputuotoksessa n√§kyy, voit halutessasi katsoa t√§√§lt√§. 13.5 Ensimm√§inen chunk Ensimm√§inen chunk on erityinen: sen nimen tulee olla ‚Äúr setup‚Äù. T√§ss√§ ensimm√§isess√§ chunkissa s√§√§d√§t asetuksia, jotka koskevat kaikkia my√∂hemmin chunkeja. Lis√§ksi t√§ss√§ voit ladata source- eli l√§hdetiedoston, josta √§skett√§in s√§√§t√§m√§si datasetti ‚Äúautoja2‚Äù l√∂ytyy. Tee seuraavat muokkaukset ensimm√§iseen chunkiin: Kutsu dplyr-paketti library-komennolla Lis√§√§ minun_datani.R ensimm√§iseen chunkiin Ensimm√§isen chunkin pit√§isi n√§ytt√§√§ seuraavalta: ```{r setup, include=FALSE} knitr::opts_chunk$set(echo = TRUE) library(dplyr) source(&quot;minun_datani.R&quot;) ``` R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["analyysej√§-r-markdownilla.html", "14 Analyysej√§ R Markdownilla 14.1 Datasetin tarkastelu 14.2 Muuttujien tarkastelu 14.3 Kuvaajat 14.4 Lineaarinen regressio", " 14 Analyysej√§ R Markdownilla Voit nyt alkaa analysoida dataasi ‚Äúautoja2‚Äù R Markdown -dokumentissasi. Voit halutessasi tuhota RStudion sabluunasta teksti√§ ja chunkeja tai kirjoittaa niiden p√§√§lle. Varo kuitenkin sotkemasta YAML-otsikkoa tai ensimm√§ist√§ ‚Äúr setup‚Äù -chunkia. 14.1 Datasetin tarkastelu 14.1.1 head-komento Hy√∂dynn√§mme eritt√§in hy√∂dyllist√§ komentoa head, joka tulostaa ensimm√§iset 6 rivi√§ datastamme. Saamme luotua pikasilm√§yksen dataamme ja halutessamme jaettua sen R Markdownin muodossa eteenp√§in. Voit esim. kirjoittaa ‚ÄúT√§ss√§ muutaman rivin ote valmiista datastamme t√§ss√§ artikkelissa‚Äù. Sen j√§lkeen voit ly√∂d√§ enterill√§ pari tyhj√§√§ rivi√§ ja kirjoittaa seuraavan chunkin, jossa pit√§√§ siis olla gravisaksentteja 3 kpl alussa ja lopussa: ```{r head_datastamme, echo=FALSE} head(autoja2) ``` T√§ss√§ muutaman rivin ote valmiista datastamme t√§ss√§ artikkelissa. ## # A tibble: 6 x 5 ## Automerkit bensankulutus_eu hevosvoima_eu massa_eu vaihteisto ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; ## 1 Mazda RX4 11.2 112. 1188. 1 ## 2 Mazda RX4 Wag 11.2 112. 1304. 1 ## 3 Hornet Sportabout 12.6 177. 1560. 0 ## 4 Duster 360 16.4 248. 1619. 0 ## 5 Merc 240D 9.64 62.9 1447. 0 ## 6 Merc 230 10.3 96.3 1429. 0 Vaikka tibble on n√§pp√§r√§ monella tapaa, henkil√∂kohtaisesti en pid√§ tavasta, jolla tibble-tyyppisten datasettien desimaalipaikat tulostuvat. Apuun t√§ss√§ (ja monessa muussa yhteydess√§) tulostusj√§ljen kaunistamiseksi tulee komento kable, josta seuraavaksi. 14.1.2 kable kaunistaa Jotta tuloste olisi n√§timp√§√§ katsella, lis√§t√§√§n viel√§ komento kable, joka tulee paketin knitr mukana. Voit asentaa kyseisen paketin antamalla konsoliin seuraavan k√§skyn: install.packages(&quot;knitr&quot;) T√§m√§n lis√§ksi sinun kannattaa kutsua knitr k√§ytt√∂√∂n lis√§√§m√§ll√§ se ensimm√§iseen, r setup -nimiseen chunkiin. T√§m√§n j√§lkeen ensimm√§inen chunkisi n√§ytt√§√§ seuraavalta: ```{r setup, include=FALSE} knitr::opts_chunk$set(echo = TRUE) library(dplyr) library(knitr) source(&quot;minun_datani.R&quot;) ``` T√§m√§n j√§lkeen p√§√§set k√§ytt√§m√§√§n kable-komentoa. Putkitetaan kaikki komennot seuraavasti: ```{r head_datastamme_kable, echo=FALSE} autoja2 %&gt;% head %&gt;% kable ``` N√§et nyt kauniimman tulosteen: Automerkit bensankulutus_eu hevosvoima_eu massa_eu vaihteisto Mazda RX4 11.200000 111.52793 1188.432 1 Mazda RX4 Wag 11.200000 111.52793 1304.100 1 Hornet Sportabout 12.577540 177.43080 1560.384 0 Duster 360 16.447552 248.40312 1619.352 0 Merc 240D 9.639344 62.86120 1446.984 0 Merc 230 10.315789 96.31958 1428.840 0 14.1.3 tail-komento Komento tail tekee saman kuin head mutta toisesta suunnasta eli n√§ytt√§√§ datasetin 6 viimeist√§ rivi√§. ```{r tail_datastamme_kable, echo=FALSE} autoja2 %&gt;% tail %&gt;% kable ``` Automerkit bensankulutus_eu hevosvoima_eu massa_eu vaihteisto Porsche 914-2 9.046154 92.26402 970.7040 1 Lotus Europa 7.736842 114.56960 686.2968 1 Ford Pantera L 14.886076 267.66704 1437.9120 1 Ferrari Dino 11.939086 177.43080 1256.4720 1 Maserati Bora 15.680000 339.65325 1619.3520 1 Volvo 142E 10.990654 110.51404 1261.0080 1 14.2 Muuttujien tarkastelu 14.2.1 min, max, mean dplyr:in k√§skyll√§ summarise voimme helposti katsoa esim. minimi- ja maksimiarvot sek√§ keskiarvot haluamistamme muuttujista: ```{r keskiarvoja, echo=FALSE} # Valitaan datasettimme &quot;autoja2&quot; k√§sittelyyn: autoja2 %&gt;% # K√§ytet√§√§n summarise-k√§sky√§: summarise(bensankulutuksen_minimi = min(bensankulutus_eu), bensankulutuksen_maksimi = max(bensankulutus_eu), bensankulutuksen_keskiarvo = mean(bensankulutus_eu)) %&gt;% # Kaunistetaan j√§lki kablella: kable ``` bensankulutuksen_minimi bensankulutuksen_maksimi bensankulutuksen_keskiarvo 7.736842 22.61538 13.60331 Voit my√∂s tulostaa tietyn tunnusluvun - vaikkapa keskiarvon - useammalle muuttujalle k√§ytt√§m√§ll√§ komentoa summarise_at. Kannattaa kirjoittaa ennen seuraavaa koodia viel√§ vapaata teksti√§, esim. Alla n√§kyy datasetin ‚Äúautoja2‚Äù muuttujien keskiarvoja. ```{r keskiarvoja2, echo=FALSE} # Valitaan datasettimme &quot;autoja2&quot; k√§sittelyyn autoja2 %&gt;% # K√§ytet√§√§n k√§sky√§ summarise at. Halutut muuttujat t√§ytyy # ilmaista rotlassa seuraavasti: # c(&quot;muuttuja1&quot;, &quot;muuttuja2&quot;, &quot;muuttuja3&quot;) # N√§iden j√§lkeen tulee viel√§ haluttu tunnusluku, seuraavassa valittiin mean summarise_at(c(&quot;bensankulutus_eu&quot;, &quot;hevosvoima_eu&quot;, &quot;massa_eu&quot;), mean) %&gt;% # Kaunistetaan j√§lki kablella kable ``` Alla n√§kyy datasetin ‚Äúautoja2‚Äù muuttujien keskiarvoja. bensankulutus_eu hevosvoima_eu massa_eu 13.60331 165.9536 1551.711 T√§st√§ analyysist√§ k√§y ilmi, ett√§ datasetin ‚Äúautot2‚Äù sis√§lt√§m√§t autot ovat kohtalaisia bensasy√∂pp√∂j√§. 14.2.2 summary Funktiolla summary() saat yhteenvedon koko datasetist√§si. ```{r summary, echo=FALSE} autoja2 %&gt;% summary %&gt;% kable() ``` Automerkit bensankulutus_eu hevosvoima_eu massa_eu vaihteisto Length:25 Min. : 7.737 Min. : 52.72 Min. : 686.3 0:16 Class :character 1st Qu.:11.200 1st Qu.:111.53 1st Qu.:1304.1 1: 9 Mode :character Median :13.213 Median :177.43 Median :1560.4 NA NA Mean :13.603 Mean :165.95 Mean :1551.7 NA NA 3rd Qu.:15.474 3rd Qu.:207.85 3rd Qu.:1714.6 NA NA Max. :22.615 Max. :339.65 Max. :2460.3 NA Halutessasi voit ajaa komennon summary my√∂s jokaiselle datasettisi muuttujalle erikseen, kun ‚Äúlooppaat‚Äù summaryn sapply-nimisen komennon l√§pi. T√§ll√∂in et voi kuitenkaan k√§ytt√§√§ kablea, joten j√§lki on rujompaa. ```{r sapply2, echo=FALSE} autoja2 %&gt;% sapply(summary) ``` ## $Automerkit ## Length Class Mode ## 25 character character ## ## $bensankulutus_eu ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 7.737 11.200 13.213 13.603 15.474 22.615 ## ## $hevosvoima_eu ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 52.72 111.53 177.43 165.95 207.85 339.65 ## ## $massa_eu ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 686.3 1304.1 1560.4 1551.7 1714.6 2460.3 ## ## $vaihteisto ## 0 1 ## 16 9 R:lle on useita paketteja, joiden avulla saa kauniimpaa ja monipuolisempaa kuvailua datasetist√§si kuin mihin summary-komento pystyy. Seuraavaksi esitell√§√§n er√§s t√§llainen. 14.2.3 summarytools summarytools-paketin funktioilla saa kauniita ja monipuolisia esityksi√§ datasetist√§si. Asentaminen tapahtuu siten, ett√§ kirjoitat konsoliin install.packages(\"summarytools\") ja painat enteri√§. 14.2.3.1 dfSummary dfSummary antaa hyvin monipuolisen esityksen koko datasetist√§si. Katso alla esimerkki√§ datasetist√§mme ‚Äúautoja2‚Äù. Aja seuraava koodi: ```{r summarytools2, echo=FALSE, results=&quot;asis&quot;} # summarytools vaatii ylle m√§√§reen results=&quot;asis&quot; jotta j√§lki n√§ytt√§√§ # R Markdownissa kauniilta. library(summarytools) autoja2 %&gt;% dfSummary(varnumbers = FALSE, plain.ascii = FALSE, style = &quot;grid&quot;, graph.magnif = 0.75, max.distinct.values = 3, # Laitoin t√§h√§n 3, jotta ei # l√§hde listaamaan automerkkej√§ # rivikaupalla. valid.col = FALSE, tmp.img.dir = &quot;/tmp&quot;) ``` N√§et t√§m√§n j√§lkeen seuraavan yhteenvedon: Variable Stats / Values Freqs (% of Valid) Graph Missing Automerkit [character] 1. AMC Javelin 2. Cadillac Fleetwood 3. Camaro Z28 [ 22 others ] 1 ( 4.0%) 1 ( 4.0%) 1 ( 4.0%) 22 (88.0%) 0 (0.0%) bensankulutus_eu [numeric] Mean (sd) : 13.6 (3.8) min &lt; med &lt; max: 7.7 &lt; 13.2 &lt; 22.6 IQR (CV) : 4.3 (0.3) 20 distinct values 0 (0.0%) hevosvoima_eu [numeric] Mean (sd) : 166 (68.8) min &lt; med &lt; max: 52.7 &lt; 177.4 &lt; 339.7 IQR (CV) : 96.3 (0.4) 17 distinct values 0 (0.0%) massa_eu [numeric] Mean (sd) : 1551.7 (440.4) min &lt; med &lt; max: 686.3 &lt; 1560.4 &lt; 2460.3 IQR (CV) : 410.5 (0.3) 22 distinct values 0 (0.0%) vaihteisto [factor] 1. 0 2. 1 16 (64.0%) 9 (36.0%) 0 (0.0%) 14.2.3.2 descr summarytools-paketin funktio descr ottaa datasetist√§ vain jatkuvat (numeeriset) muuttujat k√§sittelyyn, ja n√§ytt√§√§ niist√§ erilaisia tunnuslukuja k√§ytt√§j√§n toiveita noudattaen. Tarkastele seuraavia esimerkkej√§. Ensimm√§inen esimerkki: ```{r descr, echo=FALSE, results=&quot;asis&quot;} library(summarytools) descr(autoja2, stats = &quot;common&quot;, transpose = TRUE, headings = FALSE) ``` Pyysimme ‚Äúcommon‚Äù tunnuslukuja - n√§et t√§h√§n alle tulostuneesta taulukosta mit√§ ne descr-komennon mielest√§ ovat. Huomaa, ett√§ R heitt√§√§ taulukon yl√§puolelle herjan, ett√§ vain numeeriset muuttujat p√§√§siv√§t analyysiin, mik√§ oli tiedossa: ## Non-numerical variable(s) ignored: Automerkit, vaihteisto ¬† Mean Std.Dev Min Median Max N.Valid Pct.Valid bensankulutus_eu 13.60 3.82 7.74 13.21 22.62 25.00 100.00 hevosvoima_eu 165.95 68.76 52.72 177.43 339.65 25.00 100.00 massa_eu 1551.71 440.39 686.30 1560.38 2460.33 25.00 100.00 Toisessa esimerkiss√§ m√§√§rittelemme itse haluamamme tunnusluvut: ```{r descr2, echo=FALSE, results=&quot;asis&quot;} library(summarytools) descr(autoja2, stats = c(&quot;mean&quot;,&quot;sd&quot;,&quot;min&quot;,&quot;max&quot;), transpose = TRUE, headings = FALSE) ``` ## Non-numerical variable(s) ignored: Automerkit, vaihteisto ¬† Mean Std.Dev Min Max bensankulutus_eu 13.60 3.82 7.74 22.62 hevosvoima_eu 165.95 68.76 52.72 339.65 massa_eu 1551.71 440.39 686.30 2460.33 Kirjoittamalla konsoliin ?descrsaat tiet√§√§ tarkemmin, mit√§ kaikkia tunnuslukuja (Helpin kohta ‚Äústats‚Äù) voit funktiolta descr pyyt√§√§. 14.2.3.3 freq summarytools-paketin funktiolla freq tutkitaan kategoristen muuttujien ominaisuuksia: n-lukuja, prosentuaalisia osuuksia ja kategorioiden kumulatiivista frekvenssi√§. Olen s√§√§t√§nyt alla olevaan esimerkkikoodiin asetukset siten, ett√§ t√§m√§ funktio olisi mahdollisimman paljon SASin loistavan PROC FREQin kaltainen. ```{r freq, echo=FALSE, results=&quot;asis&quot;} library(summarytools) st_options(freq.cumul = TRUE, freq.totals = TRUE, freq.report.nas = FALSE, plain.ascii = FALSE, headings = FALSE) freq(autoja2$vaihteisto, style = &#39;rmarkdown&#39;, caption = &#39;Frequencies: autoja2$vaihteisto&#39;) ``` Tarkastelemme yll√§ n√§kyv√§n koodin kanssa datasetin ‚Äúautoja2‚Äù kategorisen muuttujan ‚Äúvaihteisto‚Äù kategorioiden (0 ja 1) tunnuslukuja. Otin yksist√§√§n t√§m√§n kirjan lukujen numerointiin liittyvist√§ ‚Äúpainoteknisist√§‚Äù syist√§ otsikot pois; samasta syyst√§ lis√§sin k√§sin otsikon (caption-tekstin). Taulukko n√§kyy t√§ss√§ alla: Frequencies: autoja2$vaihteisto ¬† Freq % % Cum. 0 16 64.00 64.00 1 9 36.00 100.00 Total 25 100.00 100.00 14.2.3.4 ctable summarytools-paketin funktio ctable pystyy tekem√§√§n ristiintaulukointeja hieman samaan tapaan kuin SASin PROC FREQ. T√§t√§ harjoitusta varten teemme uuden kategorisen muuttujan ‚Äúbensasyoppo‚Äù: ```{r ctable, echo=FALSE, results=&#39;asis&#39;} library(summarytools) # Tehd√§√§n t√§t√§ demoa varten uusi muuttuja &quot;bensasyoppo&quot; autoja2 %&gt;% mutate(bensasyoppo = ifelse(bensankulutus_eu &lt; 13.2, 0, 1)) -&gt; autoja3 autoja3$bensasyoppo &lt;- as.factor(autoja3$bensasyoppo) ctable(x = autoja3$vaihteisto, y = autoja3$bensasyoppo, prop = &#39;r&#39;, totals = T, headings = FALSE) ``` bensasyoppo 0 1 Total vaihteisto 0 5 (31.2%) 11 (68.8%) 16 (100.0%) 1 7 (77.8%) 2 (22.2%) 9 (100.0%) Total 12 (48.0%) 13 (52.0%) 25 (100.0%) 14.2.4 questionr::freq Olen nyttemmin k√§ytt√§nyt summarytools-paketin funktion freq asemesta aika paljon questionr-paketin funktiota freq. T√§st√§ on seuraavia etuja: Jos ajaa analyysin vain chunkissa (painaa play-nappulaa chunkin oikeassa yl√§laidassa), analyysin tulos n√§kyy mukavassa, ‚Äúei-ASCIImaisessa‚Äù painoasussa chunkin alla. Jos YAML-osuuteen dokumentin alussa kirjoittaa HTLM-tiedoston muodoksi ‚Äúpaged‚Äù, questionr::freq:n sama n√§tti asuu jatkuu viel√§ HTML-tiedostonkin puolella, kun on painanut nappia Knit. Huonouksia: K√§sitelt√§v√§n muuttujan nimi ei printtaannu minnek√§√§n T√§m√§n voi huomioida siten, ett√§ laittaa RMarkdownissa alaotsikkoon kyseisen muuttujan risuaitojen per√§√§n Alla toimiva esimerkki YAML-osuuksineen. 14.2.5 table1 Kannattaa harkita my√∂s table1-paketin asentamista. Toinen yht√§ hyv√§ vaihtoehto on paketti tableone. N√§iss√§ kummassakin tarkoituksena on, ett√§ hyvin yksinkertaisella k√§skyll√§ generoituisi mahdollisimman valmis ‚ÄúTable 1. Characteristics‚Äù -taulukko ty√∂stett√§v√§√§n artikkeliin. Voit halutessasi asentaa table1-paketin antamalla seuraavan k√§skyn konsoliin: install.packages(&quot;table1&quot;) T√§m√§n j√§lkeen voit kokeilla paketin toimintaa seuraavasti: ```{r table1, echo=FALSE} library(table1) label(autoja2$bensankulutus_eu) &lt;- &quot;Polttoaineenkulutus&quot; label(autoja2$hevosvoima_eu) &lt;- &quot;Hevosvoima&quot; label(autoja2$massa_eu) &lt;- &quot;Massa&quot; label(autoja2$vaihteisto) &lt;- &quot;Vaihteisto&quot; units(autoja2$bensankulutus_eu) &lt;- &quot;l/100 km&quot; units(autoja2$massa_eu) &lt;- &quot;kg&quot; table1(~ bensankulutus_eu + hevosvoima_eu + massa_eu + factor(vaihteisto), caption = &quot;Table 1. Characteristics&quot;, data=autoja2) ``` Table 1. Characteristics Overall(N=25) Polttoaineenkulutus (l/100 km) Mean (SD) 13.6 (3.82) Median [Min, Max] 13.2 [7.74, 22.6] Hevosvoima Mean (SD) 166 (68.8) Median [Min, Max] 177 [52.7, 340] Massa (kg) Mean (SD) 1550 (440) Median [Min, Max] 1560 [686, 2460] factor(vaihteisto) 0 16 (64.0%) 1 9 (36.0%) 14.3 Kuvaajat Voit helposti lis√§t√§ kuvaajia R Markdown -dokumenttiisi. Tarkastelemme seuraavaksi Base-R:n komentoa plot ja sen j√§lkeen monipuolista ggplotia. 14.3.1 plot Komento plot kuuluu karvalakki-R:√§√§n. Kokeile seuraavaa koodia: ```{r bensankulutus, echo=FALSE} plot(autoja2$hevosvoima_eu, autoja2$bensankulutus_eu) ``` 14.3.2 ggplot2 Hiemankin monimutkaisemmissa kuvaajissa suosittelen, ett√§ harkitset paketin ggplot2 asentamista antamalla konsolissa k√§skyn: install.packages(&quot;ggplot2&quot;) T√§m√§n j√§lkeen voit tehd√§ uudelleen edell√§ jo esitetyn kuvaajan ggplot2:lla, ja voit esimerkiksi lis√§t√§ mukaan regressiosovitteen seuraavasti: ```{r bensankulutus_ggplot2, echo=FALSE, message = FALSE} # ggplot2 on jonkun verran &quot;puhelias&quot;, joten lis√§sin # option message = FALSE ylle; voit toki kokeilla # sen pois ottamista. library(ggplot2) ggplot(autoja2, aes(hevosvoima_eu, bensankulutus_eu)) + geom_point() + geom_smooth(method=&#39;lm&#39;) # + theme_classic() # voit ottaa yll√§ olevan risuaidan pois, jos tahdot klassisen teeman ``` Jos et pid√§ taustav√§reist√§ tai ylip√§√§ns√§ v√§reist√§ kuvaajassasi, n√§it√§ voi s√§√§t√§√§ loputtomiin helposti ja hyvinkin pikkutarkasti ggplot2:sta k√§ytett√§ess√§. My√∂s valmiita erilaisia teemoja on; voit halutessasi kokeilla milt√§ theme_classic n√§ytt√§√§ poistamalla sen edest√§ risuaidan ylt√§ esimerkkikoodista. 14.4 Lineaarinen regressio Tutkimme edell√§ hevosvoiman ja bensankulutuksen yhteytt√§ kuvaajilla. Voit tutkia samaa kysymyksenasettelua numeerisesti lineaarisella regressiolla. 14.4.1 Yksinkertainen regressio Aloitamme ns. yksinkertaisella lineaarisella regressiolla: ```{r simppeliregressio, echo=FALSE} # Jotta koodi toimii, vaaditaan kohta data = . mik√§ tarkoittaa sit√§, # ett√§ &quot;putkesta&quot; l√§pi tullut data otetaan regressiomalliin mukaan. autoja2 %&gt;% lm(bensankulutus_eu ~ hevosvoima_eu, data = .) %&gt;% summary() ``` ## ## Call: ## lm(formula = bensankulutus_eu ~ hevosvoima_eu, data = .) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.7143 -1.4745 -0.2755 0.8574 7.3742 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.115144 1.477471 4.816 7.37e-05 *** ## hevosvoima_eu 0.039096 0.008249 4.739 8.91e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.779 on 23 degrees of freedom ## Multiple R-squared: 0.4941, Adjusted R-squared: 0.4721 ## F-statistic: 22.46 on 1 and 23 DF, p-value: 8.912e-05 Tarkastellaan ylt√§ tuloksia. Kun tutkittiin hevosvoiman assosiaatiota bensankulutukseen, kulmakertoimeksi tuli 0.039096 ja P-arvoksi 8.91e-05 ***. Hevosvoima n√§ytt√§√§ siis olevan yhteydess√§ bensankulutukseen, ainakin yksinkertaisella lineaarisella regressiolla tutkittuna. J√§lki ruudulla vain on rujohkon n√§k√∂ist√§ karvalakki-R:n summary-komennolla tuotettuna. Avuksi tulee tidy, siit√§ lis√§√§ seuraavassa. 14.4.2 tidy Edellisess√§ kappaleessa ajoimme yksinkertaista lineaarista regressiota ja tarkastelimme tuloksia komennolla summary, jonka tuottama tuloste ruudulla ei kuitenkaan ole silm√§lle miellytt√§v√§√§. Asian korjaamiseksi voit harkita paketin broom asentamista. Kyseisen paketin mukana tulee komento tidy, jolla regressiomallin tuloksen saa jaettua kauniissa muodossa kun samaan putkeen viel√§ laitetaan kable. Paketin broom voit asentaa ajamalla konsolissa seuraavan k√§skyn: install.packages(&quot;broom&quot;) T√§m√§n j√§lkeen voit ajaa seuraavan koodin: ```{r simppeliregressio_tidy, echo=FALSE} # Huom. voit laittaa library(broom) -komennon my√∂s suoraan r setup -chunkiisi, # jolloin sit√§ ei tarvitse jatkuvasti toistella: library(broom) # Jotta koodi toimii, vaaditaan kohta data = . mik√§ tarkoittaa sit√§, # ett√§ &quot;putkesta&quot; l√§pi tullut data otetaan regressiomalliin mukaan. autoja2 %&gt;% lm(bensankulutus_eu ~ hevosvoima_eu, data = .) %&gt;% tidy %&gt;% kable ``` Kuten alla n√§et, tidy ja kable tuottavat yhteisty√∂n√§ kauniimpaa j√§lke√§ eteenp√§in jaettavaksi: term estimate std.error statistic p.value (Intercept) 7.1151438 1.4774711 4.815758 7.37e-05 hevosvoima_eu 0.0390963 0.0082491 4.739457 8.91e-05 14.4.3 Multippeli regressio Jatketaan jo edell√§ esitellyll√§ lineaarisella mallilla, mutta lis√§t√§√§n viel√§ mukaan kovariaateiksi massa ja vaihteisto. T√§ll√∂in kyseess√§ on multippeli lineaarinen regressio. ```{r multippeliregressio, echo=FALSE} library(broom) autoja2 %&gt;% lm(bensankulutus_eu ~ hevosvoima_eu + massa_eu + vaihteisto, data = .) %&gt;% tidy %&gt;% kable ``` term estimate std.error statistic p.value (Intercept) 0.8439313 2.0599787 0.4096796 0.6861899 hevosvoima_eu 0.0157904 0.0069578 2.2694621 0.0338970 massa_eu 0.0064374 0.0014619 4.4033854 0.0002477 vaihteisto1 0.4164721 1.0858710 0.3835373 0.7051768 Hevosvoima n√§ytt√§√§ olevan edelleen yhteydess√§ bensankulutukseen, ei kuitenkaan en√§√§ niin vahvasti. Massa n√§ytt√§√§ olevan enemm√§nkin yhteydess√§ bensankulutukseen. Mielenkiintoista kyll√§, vaihteisto ei n√§yt√§ olevan yhteydess√§ bensankulutukseen. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["lopuksi.html", "15 Lopuksi", " 15 Lopuksi K√§sittelimme yll√§ peruspalikat, joilla saat luotua datasettisi, tarkasteltua siin√§ olevia muuttujia, tekem√§√§n ristiintaulukointia ja kuvaajia ja jopa regressioanalyysi√§. Voit copy-pastettaa t√§st√§ pikaoppaasta koodia omiin projekteihisi. Netti on pullollaan R-oppaita, ja tahdot ep√§ilem√§tt√§ perehty√§ niihin seuraavaksi. Jos ja kun R:ll√§ koodatessa menee joskus sormi suuhun, kannattaa kysy√§ neuvoa Stack Overflow‚Äôsta (SO:sta). K√§ytt√§j√§tunnuksen luominen on siell√§ ilmaista. Jos et l√∂yd√§ SO:ta selailemalla vastausta kysymykseesi, voit esitt√§√§ sen itse siell√§. Saat vastauksen yleens√§ muutamassa tunnissa. Vastauksissa ilmenee kokeneiden koodaajien nerous, jota on vaikea olla ihailematta. Ja kuten R:n ja RStudion k√§ytt√∂, t√§m√§kin lysti on t√§ysin ilmaista. R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["versionhallinta.html", "A Versionhallinta A.1 Versionhallinta - ei vain guruille A.2 Avoimista lisensseist√§ A.3 Varaston (repository) luominen yliopiston palvelimelle A.4 SSH-avaimen luominen A.5 Varaston k√§ytt√∂ RStudiossa A.6 Yhteenveto", " A Versionhallinta Joonatan Palmu Versionhallinta on monik√§sitteinen termi, joka kuvaa R-koodin tallentamista ty√∂n edetess√§ erityiseen varastoon (repository), joka tarjoaa mm. seuraavia etuja: yht√§ useampi henkil√∂ voi osallistua projektiin ty√∂ ei vahingossa tuhoudu virheet on helpompi l√∂yt√§√§ kun vertaa toimivaa ja rikkin√§ist√§ versiota rinnakkain versionhallinta on yksi mahdollisista keinoista tieteen replikaatiokriisin ratkomisessa Yleisin ja luultavasti paras versionhallintaohjelmisto on t√§ll√§ hetkell√§ Git, jolle my√∂s Turun yliopisto tarjoaa varastotilaa. Turun yliopistossa kirjoilla olevat voivat kirjautua yliopiston palvelimeen osoitteessa gitlab.utu.fi. Yht√§ hyvi√§ vaihtoehtoja ovat GitHub ja GitLab, jotka eiv√§t vaadi kirjoillaoloa miss√§√§n oppilaitoksessa. A.1 Versionhallinta - ei vain guruille Versionhallinta voi √§kkiselt√§√§n n√§ytt√§yty√§ monimutkaisena k√§sitteen√§, jonka aloittelija mielell√§√§n j√§tt√§isi vain edistyneille koodaajille. Olemme nostaneet aiheen esiin kuitenkin jo t√§ss√§ R-pikaoppaassa, sill√§ versionhallinnan k√§ytt√∂√∂n kannattaa totutella niin aikaisin kuin mahdollista, jo yll√§ kuvatuista syist√§. T√§ss√§ oppaassa esitell√§√§n alla metodi, jolla saat vaivatta versionhallinnan arvokkaana ty√∂kaluna projektiisi heti alusta alkaen. A.2 Avoimista lisensseist√§ Jos ei ole erityist√§ syyt√§ toimia toisin, on omaan R-koodiin aina hyv√§ heti alussa liitt√§√§ mukaan avoin lisenssi - ts. k√§ytt√∂lupa, joka oikeuttaa muiden k√§ytt√§√§ ty√∂t√§ haluamallaan tavalla (tekij√§n lisenssiss√§ osoittamin oikeuksin). Avoimista lisensseist√§ saa tietoa osoitteesta ChooseALicense.com. Kyseinen sivusto ohjaa sopivan lisenssin valinnassa, on sitten kyse tietokoneella luodusta ohjelmakoodista, videoista tai sekalaisia ty√∂n muotoja sis√§lt√§vist√§ projekteista. Mainittakoon, ett√§ t√§lle R-oppaalle on luotu lisenssi Creative Commonsin palvelussa, jossa sopivan lisenssin saa muutamalla klikkauksella valittua avautuvista valikoista. Creative Commonsin lisenssit soveltuvat erityisen hyvin esim. kirjojen, valokuvien ja musiikin lisensoitiin. Internetist√§ l√∂ytyy valtavasti esimerkkikoodia, jonka hy√∂dynt√§mist√§ vaikeuttaa valitettavan paljon lisenssitiedon puuttuminen. Tyypillisesti tekij√§noikeuden omistajaa ei en√§√§ ole mahdollista j√§lkik√§teen tavoittaa luvan kysymiseksi, eli py√∂r√§ joudutaan keksim√§√§n uudelleen. T√§m√§ ep√§kohta olisi helposti torjuttavissa, kun jokaiseen projektiin liitett√§isiin alusta asti selke√§ lisenssi. Omien analyysien uskottavuutta ja toistettavuutta lis√§√§ merkitt√§v√§sti artikkelin rinnalla julkaistu avoimesti lisensoitu analyysikoodi. Omasta ohjelmakoodista voi tehd√§ helposti viitattavaa CERN:n Zenodo-palvelua k√§ytt√§en, jolloin esimerkiksi koodit sis√§lt√§v√§lle zip-tiedostolle (ladattavissa suoraan yliopiston Git-palvelimelta) saa pysyv√§n arkistointipaikan ja DOI-tunnuksen. Alla n√§kyv√§√§n taulukkoon on listattu muutamia keskeisimpi√§ peruslisenssej√§. Voit lukea lis√§√§ erilaisista avoimista lisensseist√§ halutessasi Wikipediasta. Table A.1: Muutama valikoitu peruslisenssi Avoimen lisenssin nimi Lisenssin kuvaus Huomioitavaa MIT √Ñ√§rimmilleen typistetty yksinkertainen ja salliva peruslisenssi Soveltuu hyvin ohjelmointikoodin lisensointiin CC-BY 4.0 Yksi Creative Commonsin lisensseist√§: ty√∂ vapaasti muunneltavissa ja jaettavissa, mutta johdannaisen l√§hde on mainittava Ei sovellu hyvin ohjelmointikoodin lisensointiin LGPLv3 Ty√∂ on vapaasti muunneltavissa, mutta my√∂s julkaistun johdannaisen pit√§√§ olla avoin Soveltuu erinomaisesti ohjelmointikoodin lisensointiin Saat haettua projektillesi lisenssin my√∂s suoraan Gitlabiss√§ sen valmiilla malleilla (template) alla olevassa kuvassa esitett√§v√§ll√§ tavalla. A.3 Varaston (repository) luominen yliopiston palvelimelle Mene verkkoselaimellasi osoitteeseen gitlab.utu.fi Valitse oikealta ylh√§√§lt√§ New project -nappi Luo uusi projekti painikkeesta Create blank project. Projektille kannattaa valita kuvaava nimi T√§ss√§ vaiheessa n√§kyvyyden voi valita salatuksi (private), jos koodi julkistetaan vasta artikkelin julkaisun yhteydess√§ Projektin luomisen j√§lkeen k√§ytt√§j√§lle aukeaa alhaalla olevan kuvan kaltainen n√§kym√§, josta Clone-napin alta l√∂ytyy projektin SSH-osoite ja Add LICENSE-napin takaa voi projektille lis√§t√§ lisenssin valmiita malleja (template) k√§ytt√§en. Gitlabin k√§ytt√∂liittym√§ A.4 SSH-avaimen luominen RStudion ja Git-palvelimen v√§linen tiedonsiirto edellytt√§√§ ssh-avaimen luomista Linuxissa ja Mac:ss√§ t√§m√§ tapahtuu helposti antamalla terminaalissa komento ssh-keygen T√§m√§n j√§lkeen julkinen avain (~/.ssh/id_rsa.pub) pit√§√§ kopioida yliopiston palvelimelle osoitteessa https://gitlab.utu.fi/-/profile/keys Avaimen luominen on mahdollista my√∂s Windowsissa Jos windowsin shell ei tunnista ssh- tai ssh-keygen -komentoja, t√§ytyy Optional Features -valikosta asentaa OpenSSH Client Tarkemmat ohjeet Macille kuvineen alla: Avaa Maciss√§ Terminal (avautuu mm. seuraavasti: paina Omppu+v√§lily√∂ntin√§pp√§in ja kirjoita terminal ja paina enteri√§) ja kirjoita Terminaliin ssh-keygen ja paina enteri√§: MacOS ehdottaa kohdetta, johon SSH-avain tallennetaan - voit hyv√§ksy√§ ehdotuksen: MacOS kysyy salasanaa SSH-avaimelle; kun se nyt tulee k√§ytt√∂√∂n RStudion ja gitlab.utu.fi:n v√§lille, itse j√§tt√§isimme salasanan t√§ss√§ asettamatta painamalla pariin otteeseen pelkk√§√§ enteri√§: T√§m√§n j√§lkeen MacOS n√§ytt√§√§, mihin SSH-avain on tallennettu: Nyt voit kirjoittaa cat /Users/sinunk√§ytt√§j√§nimesi/.ssh/id_rsa.pub, jolloin koko SSH-avain tulostuu n√§yt√∂lle, ja voit kopioida SSH-avaimen leikep√∂yd√§lle (maalaa jo sanoista ssh-rsa ja lopussa aina Mac-koneesi tyyppi√§ my√∂den, t√§ss√§ tapauksessa -MBP): Voit nyt logata gitlab.utu.fi:hin ja klikata oikealle yl√∂s omaan avatariisi, jonka alta valitaan Preferences, ja edelleen vasemmasta laidasta SSH Keys: T√§m√§n j√§lkeen SSH-avaimesi pastetetaan kohtaan Key leikep√∂yd√§lt√§, jonne √§sken SSH-avaimesi tallensit, ja klikataan Add key: A.5 Varaston k√§ytt√∂ RStudiossa Valitse valikosta File, New Project, Version Control ja Git (alla kuva). Lis√§√§ t√§h√§n projektin internet-sivuilta Clone-napin alta kopioitu SSH-osoite Projektin luominen RStudioon Kun projekti on tuotu paikalliselle koneelle, voi siihen lis√§t√§ analyyseiss√§ tarvittavia tiedostoja valitsemalla File New ja R markdown Uuden tiedoston lis√§√§misess√§ on kaksi vaihetta: tiedoston siirt√§minen versionhallintaan eli kommitointi (commit), ja tehtyjen muutosten siirt√§minen omalta koneelta palvelimelle eli pushaus Aina kun on tehty merkitt√§v√§ muutos, lis√§t√§√§n se versiohallintaan k√§ytt√§en alla olevassa kuvassa n√§kyvi√§ nappeja GIT, Staged, Commit ja Push Projektin luominen RStudioon Tiedoston siirtymisen yliopiston palvelimelle voi tarkistaa katsomalla projektin internetsivua selaimella Kun tiedosto on kerran lis√§tty versiohallintaan, voi jatkossa sit√§ koskevat muutokset p√§ivitt√§√§ Git-napin takaa Commit-nappia painamalla. Kommitoidessa on hyv√§ tapa liitt√§√§ kuvailu tehdyist√§ muutoksista. Tehdyt commitit pit√§√§ viel√§ siirt√§√§ yliopiston palvelimelle Push-napista. Muutokset kannattaa kommitoida aina kun saa koodissa jonkin kokonaisuuden valmiiksi tai esimerkiksi virheen korjattua. Vaihtoehtoisesti t√§m√§n voi tehd√§ aina p√§iv√§n p√§√§tteeksi. A.6 Yhteenveto Kolme yksinkertaista keinoa parantaa merkitt√§v√§sti omia analyysej√§, niiden toistettavuutta ja yhteisty√∂mahdollisuuksia: K√§yt√§ versionhallintaa (pieni investointi maksaa vaivan monin kerroin) Lis√§√§ koodiin avoin lisenssi (my√∂s oma n√§kyvyys lis√§√§ntyy, jos muut jakavat ty√∂t√§si) K√§yt√§ R-kirjastojen hallinnoimiseen packrat- tai renv-pakettihallintaa (analyysit on mahdollista toistaa viel√§ yli 6‚Äì12 kk:n kuluttua) N√§iden k√§ytt√∂√§ ei k√§sitell√§ t√§ss√§ R-oppaassa, mutta renv esitell√§√§n hyvin havainnollistavasti t√§ss√§ YouTube-videossa (jos olet kiireinen, kelaa suoraan videon kohtaan 10:20) R-opas by Ville Lang√©n is licensed under Attribution-ShareAlike 4.0 International "],["rstudio-ja-ssh.html", "B RStudio ja SSH B.1 Rstudion terminaali B.2 SSH-avaimet B.3 Tmux B.4 Et√§yhteyden avaaminen Rstudiossa B.5 Komentojen suorittaminen et√§yhteyden yli B.6 Harjoitus: survival-analyysi B.7 Yhteenveto", " B RStudio ja SSH Joonatan Palmu Raskaammassa tieteellisess√§ laskennassa saattaa tulla tarpeelliseksi siirty√§ tekem√§√§n analyysit oman kannettavan sijaan raskaalle tietokoneklusterille. T√§m√§ saattaa my√∂s olla tarpeen, jos tutkittava aineiston saatavuutta on rajoitettu tiettyyn pilveen. Usein klusterit on toteutettu Linuxia k√§ytt√§en. Sujuvan tutkimusty√∂n kannalta olisi kuitenkin analyysit hy√∂dyllist√§ pysty√§ edelleen ajamaan interaktiivisesti RStudiossa omalla kannettavalla: k√§ytt√§j√§ siis kontrolloi prosesseja omalta kannettavaltaan, mutta j√§re√§mpi tietokoneklusteri toteuttaa ne. T√§m√§ on usein mahdollista seuraavia ohjeita k√§ytt√§en. B.1 Rstudion terminaali RStudiossa on R console -v√§lilehden lis√§ksi Terminal-v√§lilehti. N√§iden kahden v√§lilehden erona on, ett√§ RStudio avaa edelt√§v√§√§n R komentorivin ja j√§lkimm√§iseen j√§rjestelm√§n yleisen komentokehoitteen (engl. shell), joka on t√§ss√§ tapauksessa yleens√§ nimelt√§√§n joko bash tai zsh. Yleisess√§ komentokehoitteessa voidaan suorittaa kaikenlaisia komentoja kuten esimerkiksi ajaa R-komentorivi√§ et√§yhteyden yli(!). Valitsemalla Terminal-v√§lilehti, voidaan ssh-komennolla ottaa yhteys tietokoneklusteriin. T√§ss√§ esimerkiss√§ k√§yt√§mme Turun yliopiston Linux-serveri√§. B.2 SSH-avaimet SSH-avaimet ovat salasanaa parempi vaihtoehto tunnistautumiseen sek√§ k√§yt√§nn√∂llisyyden ett√§ turvallisuuden puolesta Oman ssh-avaimen olemassaolon voi varmistaa komennolla ls ~/.ssh/id_rsa.pub Tarvittaessa uusi ssh-avain on helppo luoda komennolla ssh-keygen oletusparametreja k√§ytt√§en (√§l√§ aseta salasanaa avaimelle) Edell√§ t√§m√§n oppaan Appendix-osuudessa on kuvattu kohta kohdalta miten SSH-avain luodaan. Oman julkisen avaimen saa kerrottua palvelimelle komennolla ssh-copy-id -i ~/.ssh/id_rsa.pub linux.utu.fi T√§m√§n j√§lkeen yhdeyden k√§ytt√§minen onnistuu ilman salasanojen sy√∂tt√§mist√§ Huom. valitettavasti er√§√§t harvat palvelimet on konfiguroitu niin, ett√§ ne eiv√§t hyv√§ksy t√§t√§ hyv√§√§ tunnistautumismenetelm√§√§ Jos Windowsin shell ei tunnista ssh- tai ssh-keygen -komentoja, t√§ytyy Windowsin Optional Features -valikosta asentaa OpenSSH Client B.3 Tmux Linux-palvelin p√§√§tt√§√§ sinne k√§ynnistetyt prosessit p√§√§s√§√§nt√∂isesti SSH-yhteyden katketessa. Yhteys katkeaa usein p√§ivitt√§in koneen menness√§ offline-tilaan muun muassa lounasaikaan ja kotiin l√§hdett√§ess√§. Oman k√§ytt√∂mukavuuden vuoksi kannattaa opetella k√§ytt√§m√§√§n tmux-komentoa, joka ei yhteyden katketessa tuhoudu vaan menee vain nukkumaan. T√§ll√∂in voi my√∂s j√§tt√§√§ raskaan analyysin ajoon kotiin l√§htiess√§ eik√§ oman kannettavan sulkeminen vaikuta ajon etenemiseen. Ensimm√§isell√§ kerralla tmux k√§ynnistet√§√§n komennolla tmux Vanhaan sessioon saa palattua komennolla tmux a Tmuxin tottelee Ctrl+b alkuisia pikan√§pp√§imi√§, mutta kahdella edellisell√§ komennolla selvi√§√§ my√∂s hyvin tutustumatta hienompiin ominaisuuksiin B.4 Et√§yhteyden avaaminen Rstudiossa Kirjoitetaan Terminal-v√§lilehdelle ssh username@linux.utu.fi K√§ynnistet√§√§n tmux joko komennolla tmux tai tmux a Jos yhteys varsinaiselle palvelimelle on ep√§vakaa, kannattaa harkita yhteyden ottamista yliopiston linux-serverin kautta, joka on aina yhteydess√§ verkkoon K√§yt√§nn√∂ss√§ siis lis√§√§ t√§h√§n v√§liin komento ssh username@server K√§ynnistet√§√§n R komennolla R SSH-yhteys Linux-serverille SSH-yhteytt√§ k√§ytt√§en B.5 Komentojen suorittaminen et√§yhteyden yli Kaikkien edellisten vaiheiden tarkoituksena on saada aikaan tilanne, jossa RStudiossa kirjoitettua R-koodia kyet√§√§n l√§hett√§m√§√§n yksinkertaisella pikan√§pp√§imell√§ ajettavaksi et√§yhteyden yli ajettuun R- konsoliin. T√§llainen kehitysymp√§rist√∂ tekee interaktiivisen ja miellytt√§v√§n R-kielen kirjoittamisen mahdolliseksi - kaikki ohjelmointihan lopulta perustuu ajatukseen kokeilla interaktiivisesti erilaisia asioita ja katsoa mit√§ n√§ist√§ asioista seuraa. Siirryt√§√§n .Rmd-tiedostossa kiinnostavalle riville ja l√§hetet√§√§n t√§m√§ rivi terminaaliin pikan√§pp√§imell√§ Ctrl+Alt+Enter tai Cmd+Alt+Enter Komennon l√§hett√§minen terminaaliin (huomaa kursori rivill√§ 15) B.6 Harjoitus: survival-analyysi Teemme seuraavaksi harjoituksena survival-analyysin kuvitteellisesta 2 miljoonan tutkittavan aineistosta. Katsomme, onko sukupuolella vaikutusta survival-tuloksiin. Lataamme ensin survival-paketin sessioomme k√§skyll√§: library(survival) T√§m√§n j√§lkeen luomme kuvitteellisen datan seuraavilla k√§skyill√§: testidatamme &lt;- data.frame(id=1:2000000, gender=sample(1:2, 2000000, replace = TRUE), time=sample(1:100, 2000000, replace = TRUE), status=sample(0:1, 2000000, replace = TRUE)) testidatamme$censored &lt;- 1-testidatamme$status Survival-analyysin teemme copxph-komennolla. Otamme muistiin systeemin ajan j√§lkeen ja ennen analyysin ja tulostamme niiden erotuksen, joka kertoo analyysiin kuluneen ajan. Kaikki t√§m√§ tapahtuu seuraavilla k√§skyill√§: start_time &lt;- Sys.time() mallimme &lt;- coxph(Surv(time, status) ~ gender, data = testidatamme) summary(mallimme) ## Call: ## coxph(formula = Surv(time, status) ~ gender, data = testidatamme) ## ## n= 2000000, number of events= 1e+06 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## gender -0.0001806 0.9998194 0.0019999 -0.09 0.928 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## gender 0.9998 1 0.9959 1.004 ## ## Concordance= 0.5 (se = 0 ) ## Likelihood ratio test= 0.01 on 1 df, p=0.9 ## Wald test = 0.01 on 1 df, p=0.9 ## Score (logrank) test = 0.01 on 1 df, p=0.9 end_time &lt;- Sys.time() end_time - start_time ## Time difference of 13.66436 secs Mallin tuloksista voimme ensinn√§kin n√§hd√§, ett√§ sukupuolella ei ollut vaikutusta p√§√§tetapahtumaan, koska kaikki data oli kuvitteellista ja umpim√§hk√§ist√§. Tulosten alla n√§emme, ett√§ prosessiin kului allekirjoittaneen tietokoneella seuraava m√§√§r√§ sekunteja: ## Time difference of 13.66436 secs Voimme vertailun vuoksi ajaa samat analyysit Turun yliopiston Linux-serverill√§ seuraavasti. Kirjoita terminaaliin ssh k√§ytt√§j√§nimesi@linux.utu.fi ja paina enteri√§: Kirjoita t√§m√§n j√§lkeen terminaaliin R ja paina enteri√§: Aja yll√§ mainitut 3 koodi-chunkia seuraavasti: paina kunkin k√§skyn kohdalla Ctrl+Alt+Enter Windowsissa tai Cmd+Alt+Enter Maciss√§. Jos koodi jakaantuu usealle riville, maalaa ensin kaikki kyseisen koodi-chunkin rivit ja paina sitten vasta edelt√§v√§ss√§ virkkeess√§ mainittu kirjainyhdistelm√§: N√§emme, ett√§ sukupuoli ei vaikuttanut Linux-serverink√§√§n tekem√§ss√§ analyysiss√§ tulokseen, koska kaikki data oli tosiaan umpim√§hk√§ist√§ (huom. omat tuloksesi voivat poiketa minimaalisesti t√§ss√§ n√§ytetyist√§, koska satunnainen data luodaan uudelleen joka ajossa t√§ss√§ harjoituksessa): Lis√§ksi voimme n√§hd√§, ettei yliopiston Linux-serveri t√§ss√§ esimerkiss√§ suoriutunut allekirjoittaneen kannettavaa tietokonetta kummoisemmin. Mutta joka tapauksessa tilastoanalyysien taakkaa voi t√§ll√§ metodilla jakaa oman koneensa ja et√§koneen v√§lill√§. B.7 Yhteenveto Pyri saamaan R-kielen kehityksess√§ aikaan tilanne, jossa voit ajaa nopeasti ja interaktiivisesti erilaisia komentoja ja katsoa mit√§ n√§ist√§ komennoista seuraa Ota esimerkiksi suuresta data framesta vain osajoukko raskaaseen vaiheeseen kunnes koodip√§tk√§ toimii T√§llaisen kehitysymp√§rist√∂n saaminen aikaan on √§√§rimm√§isen t√§rke√§√§ ja siihen on hyv√§ pyyt√§√§ tarvittaessa apua (ei ole j√§rkev√§√§ olla satoja tunteja tehoton) Kannattaa pit√§√§ silm√§t auki viel√§ parempien vaihtoehtojen l√∂yt√§miseksi (esim. Visual Studio Code tai Jupyter-notebookit) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
